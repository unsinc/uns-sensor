services:
  IDS:
    image: suricata
    hostname: IDS
    container_name: IDS
    build:
      context: /sns/docker
      dockerfile: dockerfile
    restart: always
    securityContext:
      privileged: true
      capabilities:
        add: ["NET_ADMIN"]
    volumes:
      - /var/log/suricata:/var/log/suricata
      - /sns/IDS/suricata:/etc/suricata
    command: sudo iptables -I FORWARD -i eth1 -j NFQUEUE && sudo iptables -I FORWARD -i eth2 -j NFQUEUE && sudo iptables -I FORWARD -i eth3 -j NFQUEUE && sudo iptables -I FORWARD -i eth4 -j NFQUEUE && sudo iptables -I FORWARD -i eth5 -j NFQUEUE