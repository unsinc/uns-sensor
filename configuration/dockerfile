# Dockerfile to build a Suricata docker container

# Set the base image to Ubuntu
FROM ubuntu:22.04

# File Author
MAINTAINER unsinc

# Update the repos
RUN apt update

# Allows us to add repositories and rum some commands
RUN apt install -y software-properties-common wget apt-transport-https net-tools

# Add the Suricata repository
RUN add-apt-repository -y ppa:oisf/suricata-stable

# Update the repos and install Suricata
RUN apt update && apt install -y suricata && apt install net-tools

#Start the Suricata/Filebeat service when the container is started
CMD systemctl enable suricata
CMD sudo systemctl start suricata
CMD register-tenant 1 /etc/suricata/eth1/eth1.yaml
CMD register-tenant 2 /etc/suricata/eth2/eth2.yaml
CMD register-tenant 3 /etc/suricata/eth3/eth3.yaml
CMD register-tenant 4 /etc/suricata/eth4/eth4.yaml
CMD register-tenant 5 /etc/suricata/eth5/eth5.yaml
CMD reload-tenants